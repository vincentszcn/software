<html><!-- #BeginTemplate "/Templates/template.dwt" -->
<head>
<!-- #BeginEditable "doctitle" --> 
<title>Sysinternals Freeware - Information for Windows NT and Windows 2000 - Filemon</title>
<!-- #EndEditable --> 
<meta http-equiv="Content-Type" content="text/html;">
<script language="JavaScript">
<!--
function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

function MM_findObj(n, d) { //v4.0
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && document.getElementById) x=document.getElementById(n); return x;
}
//-->
</script>
<link rel=stylesheet href="../../includes/default.css" type="text/css">
</head>
<body topmargin="0" leftmargin="0" marginheight="0" marginwidth="0" bgcolor="#ffffff" background="../../images/background.gif"   onLoad="MM_preloadImages('../../images/topmenu_images/otop_menu_resources.gif','../../images/topmenu_images/otop_menu_aboutus.gif','../../images/topmenu_images/otop_menu_global.gif','../../images/sidemenu_images/oside_menu_98_utilities.gif','../../images/sidemenu_images/oside_menu_utilities.gif','../../images/sidemenu_images/oside_menu_source.gif','../../images/sidemenu_images/oside_menu_information.gif','../../images/sidemenu_images/oside_menu_98_source.gif','../../images/sidemenu_images/oside_menu_98_information.gif','../../images/topmenu_images/otop_menu_resources.gif','../../images/topmenu_images/otop_menu_sitemap.gif','../../images/topmenu_images/otop_menu_licensing.gif','../../images/topmenu_images/otop_menu_aboutus.gif','../../images/topmenu_images/otop_menu_global.gif')">
<table width="770" border="0" cellspacing="0" cellpadding="0">
  <tr> 
    <td rowspan="4" width="226" valign="top"> 
      <table width="50" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td><a href="../../index.shtml"><img src="../../images/logo.gif" width="227" height="67" border="0"></a></td>
        </tr>
        <tr valign="top"> 
          <td height="479"><SCRIPT LANGUAGE="JavaScript1.2" TYPE="text/javascript">
<!--
	JM_DOM = (document.getElementById) ? true : false;
	JM_NS4 = (document.layers) ? true : false;
	JM_NS4old = (JM_NS4 && (parseFloat(navigator.appVersion) < 4.02));
	JM_IE = (document.all) ? true : false;
	JM_IE4 = JM_IE && !JM_DOM;
	JM_IE4M = JM_IE4 && JM_Mac;
	JM_IsMenu = (JM_DOM || (JM_NS4 && !JM_NS4old) || (JM_IE && !JM_IE4M));

	
	if ((JM_NS4 || JM_DOM) && !JM_IE) {
		searchWidth = 7;
		emailWidth= 12;
		vgmWidth = 7;
	} else {
		searchWidth = 14;
		emailWidth= 14;
		vgmWidth = 11;
	}
//-->
</SCRIPT>
<table width="176" border="0" cellspacing="0" cellpadding="0" height="279">
  <tr valign="top"> 
    <td height="291"><img src="../../images/sidemenu_images/side_menu_top.gif" width="179" height="92" align="top"><br>
      <a href="../../ntw2k/utilities.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image16','','../../images/sidemenu_images/oside_menu_utilities.gif',1)"><img name="Image16" border="0" src="../../images/sidemenu_images/side_menu_utilities.gif" width="179" height="23" align="top"></a> 
      <a href="../../ntw2k/source.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image11','','../../images/sidemenu_images/oside_menu_source.gif',1)"><img name="Image11" border="0" src="../../images/sidemenu_images/side_menu_source.gif" width="179" height="22" align="top"></a> 
      <a href="../../ntw2k/information.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image12','','../../images/sidemenu_images/oside_menu_information.gif',1)"><img name="Image12" border="0" src="../../images/sidemenu_images/side_menu_information.gif" width="179" height="27" align="top"></a> 
      <img src="../../images/sidemenu_images/side_menu_middle.gif" width="179" height="50" align="top"><br>
      <a href="../../win9x/98utilities.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image13','','../../images/sidemenu_images/oside_menu_98_utilities.gif',1)"><img name="Image13" border="0" src="../../images/sidemenu_images/side_menu_98_utilities.gif" width="179" height="18" align="top"></a> 
      <a href="../../win9x/98source.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image14','','../../images/sidemenu_images/oside_menu_98_source.gif',1)"><img name="Image14" border="0" src="../../images/sidemenu_images/side_menu_98_source.gif" width="179" height="26" align="top"></a> 
      <a href="../../win9x/98information.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image15','','../../images/sidemenu_images/oside_menu_98_information.gif',1)"><img name="Image15" border="0" src="../../images/sidemenu_images/side_menu_98_information.gif" width="179" height="24" align="top"></a> 
      <img src="../../images/sidemenu_images/side_menu_linux.gif" width="179" height="50" border="0" align="top"><br>
      <a href="../../linux/utilities.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image131','','../../images/sidemenu_images/oside_menu_98_utilities.gif',1)"><img name="Image131" border="0" src="../../images/sidemenu_images/side_menu_98_utilities.gif" width="179" height="18" align="top"></a> <br><br>
    </td>
  <tr>
    <td valign="bottom"> 
      <form method="get" action="http://search.atomz.com/search/">
        <img src="../../images/sidemenu_images/side_menu_search.gif" width="179" height="25" border="0" align="top"> 
        <img src="/images/spacer.gif" width="10" height="5"> 
        <script language="JavaScript">document.write("<input type='text' size=" + searchWidth + " name='sp-q'>")</script>
        &nbsp;
        <input type="image" border="0" name="Sign Up!2" src="../../images/sidemenu_images/go.gif" width="35" height="20" alt="Sign Up!" class="floatright"  align="absmiddle">
        <input type=hidden name="sp-a" value="sp1000b352">
      </form>
    </td>
 </tr> 
</table>

 </td>
        </tr>
      </table>
    </td>
    <td colspan="2" valign="top"> 
      <table width="50" border="0" cellspacing="0" cellpadding="0">
        <tr> 
          <td><img src="../../images/top_arch.gif" width="581" height="48" align="bottom"></td>
        </tr>
        <tr valign="top"> 
          <td valign="top"><table width="581" border="0" cellspacing="0" cellpadding="0" height="48">
  <tr valign="top"> 
    <td><a href="../../othresources.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image7','','../../images/topmenu_images/otop_menu_resources.gif',1)"><img name="Image7" border="0" src="../../images/topmenu_images/top_menu_resources.gif" width="115" height="45" align="top"></a><a href="../../sitemap.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image8','','../../images/topmenu_images/otop_menu_sitemap.gif',1)"><img name="Image8" border="0" src="../../images/topmenu_images/top_menu_sitemap.gif" width="91" height="45" align="top"></a><a href="../../licensing.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image9','','../../images/topmenu_images/otop_menu_licensing.gif',1)"><img name="Image9" border="0" src="../../images/topmenu_images/top_menu_licensing.gif" width="75" height="45" align="top"></a><a href="../../aboutus.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image6','','../../images/topmenu_images/otop_menu_aboutus.gif',1)"><img src="../../images/topmenu_images/filler.gif" width="6" height="45" align="top" border="0"><img name="Image6" border="0" src="../../images/topmenu_images/top_menu_aboutus.gif" width="75" height="45" align="top"></a><a href="../../index.shtml" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image192','','../../images/topmenu_images/otop_menu_home.gif',1)"><img name="Image192" border="0" src="../../images/topmenu_images/top_menu_home.gif" width="61" height="45" align="top"></a><img src="../../images/topmenu_images/top_menu_filler.gif" width="37" height="45" align="top"><img src="../../images/topmenu_images/top_menu_end.gif" width="121" height="45" align="top"></td>
  </tr>
</table>

            <!-- #BeginEditable "Section%20title/logo" --><i><b><img
src="../../images/logos/filemon.gif" alt="Logo" width="456" height="25"><font face="arial" size="2"><a name='top'></a><br>
            </font></b></i><b>Copyright &copy; 1996-1999&nbsp;<a href="mailto:mark@sysinternals.com">Mark 
            Russinovich</a><font
color="#000000"><b> and </b></font><a
href="mailto:cogswell@winternals.com"><b>Bryce Cogswell</b></a></b><!-- #EndEditable --></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr> 
    <td colspan="2" valign="top"> 
      <table width="570" border="0" cellspacing="0" cellpadding="0">
        <tr valign="top"> 
          <td colspan="3" height="429"><!-- #BeginEditable "Body" -->
            <TABLE CELLSPACING="10" CELLPADDING="0" WIDTH="589">
              <TR valign="top" align="left"> 
                <TD COLSPAN="2" width="567"> 
                  <table width="580" border="0" cellspacing="0" cellpadding="0">
                    <tr> 
                      <td valign="top"> 
                        <table width="570" border="0" cellspacing="0" cellpadding="0" dwcopytype="CopyTableRow">
                          <tr> 
                            <td colspan="3" valign="top"><span class='include'>Last 
                              updated October 14, 2001 v4.34</span> 
                              <hr>
                            </td>
                          </tr>
                          <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>Awards</span> 
                            </td>
                          </tr>
                          <tr> 
                            <td colspan="3" valign="middle"> 
                              <p><a href="http://www.zdnet.com/downloads/stories/info/0,,000OUY,.html"><img src="../../images/bstar.gif" width="81" height="81" border="0" align="absmiddle"></a> 
                                <a href="http://www.wugnet.com"><img src="../../images/wugnet.gif" width="114" height="41" align="absmiddle" border="0"></a>
                            </td>
                          </tr>
						                            <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>Introduction</span> 
                            </td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3" align="left"><i>Filemon</i> 
                              monitors and displays file system activity on a 
                              system in real-time. Its advanced capabilities make 
                              it a powerful tool for exploring the way Windows 
                              works, seeing how applications use the files and 
                              DLLs, or tracking down problems in system or application 
                              file configurations. Filemon's timestamping feature 
                              will show you precisely when every open, read, write 
                              or delete, happens, and its status column tells 
                              you the outcome. <i>Filemon</i> is so easy to use 
                              that you'll be an expert within minutes. It begins 
                              monitoring when you start it, and its output window 
                              can be saved to a file for off-line viewing. It 
                              has full search capability, and if you find that 
                              you're getting information overload, simply set 
                              up one or more filters. 
                              <p><em>Filemon</em> works on NT 4.0, Windows 2000, 
                                Windows XP, Windows XP 64-bit Edition, Windows 
                                95, Windows 98 and Windows ME. Sysinternals also 
                                has a version of <a href="../../linux/utilities/filemon.shtml">Filemon 
                                for Linux</a>.<br>
                                <br>
                                <img src="../../images/screenshots/fileshot.gif" width="549" height="271"> 
                            </td>
                          </tr>

                          <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>Installation and Use 
</span></td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3">Simply run the <em>Filemon</em> 
                              (filemon.exe) Windows NT/2000 Note: you must have 
                              administrative privilege to run <em>Filemon</em>. 
                              When <em>Filemon</em> is started for the first time 
                              it will monitor all local hard drives. Menus, hot-keys, 
                              or toolbar buttons can be used to clear the window, 
                              select and deselect monitored drives (Windows NT/2K), 
                              save the monitored data to a file, and to filter 
                              and search output. 
                              <p>As events are printed to the output, they are 
                                tagged with a sequence number. If <em>Filemon</em>&#146;s 
                                internal buffers are overflowed during extremely 
                                heavy activity, this will be reflected with gaps 
                                in the sequence number.</p>
                              <p>Use the Filter dialog, which is accessed with 
                                a toolbar button or the Edit|Filter/Highlight 
                                menu selection, to select what data will be shown 
                                in the list view. The '*' wildcard matches arbitrary 
                                strings, and the filters are case-insensitive. 
                                Only matches shown in the include filter, but 
                                that are not excluded with the exclude filter, 
                                are displayed. Use ';' to separate multiple strings 
                                in a filter (e.g. &quot;filemon;temp&quot;). <i>Windows 
                                NT/2000 note:</i> because of the asynchronous 
                                nature of file I/O, its not possible to filter 
                                on the result field. </p>
                              <p> For example, if the include filter is &quot;c:\temp&quot;, 
                                and the exclude filter is &quot;c:\temp\subdir&quot;, 
                                all references to files and directories under 
                                c:\temp, except to those under c:\temp\subdir 
                                will be monitored. </p>
                              <p>Wildcards allow for complex pattern matching, 
                                making it possible to match specific file accesses 
                                by specific applications, for example. The include 
                                filter &#147;Winword*Windows&#148; would have 
                                <i>Filemon</i> only show accesses by Microsoft 
                                Word to files and directories that include the 
                                word &#147;Windows&#148;.</p>
                              <p>Use the highlight filter specify output that 
                                you want to have highlighted in the listview output. 
                                Select highlighting colors with Edit|Highlight 
                                Colors. </p>
                              <p><em>Filemon</em> can either timestamp events 
                                or show their duration. The Options menu and the 
                                clock toolbar button let you toggle between the 
                                two modes. The button on the toolbar shows the 
                                current mode with a clock or a stopwatch. When 
                                showing duration the Time field in the output 
                                shows the number of seconds it took for the underlying 
                                file system to service particular requests.</p>
                              <p>Each time you exit <em>Filemon</em> it remembers 
                                the filters you've configured, position of the 
                                window and the widths of the output columns.
</td>
                          </tr>
                          <tr> 
                            <td height="40" colspan="3" valign="middle"><span class='sectionheader'>Named Pipes and Mail Slots
</span></td>
                          </tr>
                          <tr> 
                            <td colspan="3" valign="TOP"> 
                              <p>Starting in version 4.1 <i>Filemon</i> is able 
                                to monitor named pipe and mail slot file system 
                                activity on Windows NT/2K. Named pipes are commonly 
                                used as a communications mechanism in NT/Win2K 
                                by core subsystems like the Local Security Authority 
                                Subsystem (LSASS), and are used by DCOM. They 
                                are also used by network components such as the 
                                Browser service. To see named pipe activity with 
                                <i>Filemon</i> select Named Pipes in the Drives 
                                menu and perform an operation on a shared network 
                                resource, or open an application such as Regedt32 
                                that interacts with the security subsystem.<br>
                                <br>
                                Mail slots are much less commonly used. If you 
                                find an application that uses mail slots, please 
                                let me know.
                            </td>
                          </tr>
                          <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>How Filemon Works

</span></td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3" align="left"> For the 
                              Windows 9x driver, the heart of <i>Filemon </i>is 
                              in the virtual device driver, Filevxd.vxd. It is 
                              dynamically loaded, and in its initialization it 
                              installs a file system filter via the VxD service, 
                              <b>IFSMGR_InstallFileSystemApiHook</b>, to insert 
                              itself onto the call chain of all file system requests. 
                              On Windows NT the heart of <em>Filemon</em> is a 
                              file system driver that creates and attaches filter 
                              device objects to target file system device objects 
                              so that <em>Filemon</em> will see all IRPs and FastIO 
                              requests directed at drives. 
                              <p>When <i>Filemon </i>sees an open, create or close 
                                call, it updates an internal hash table that serves 
                                as the mapping between internal file handles and 
                                file path names. Whenever it sees calls that are 
                                handle based, it looks up the handle in the hash 
                                table to obtain the full name for display. If 
                                a handle-based access references a file opened 
                                before <i>Filemon </i>started, <i>Filemon </i>will 
                                fail to find the mapping in its hash table and 
                                will simply present the handle's value instead. 
                              </p>
                              <p>Information on accesses is dumped into an ASCII 
                                buffer that is periodically copied up to the GUI 
                                for it to print in its listbox.
</td>
                          </tr>
						                            <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>Related 
                              Utilities</span></td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3" align="left"> <font color="#000000">Here 
                              are some other monitoring tools available at Sysinternals:</font> 
                              <ul>
                                <li><font color="#000000"><a href="../../ntw2k/source/regmon.shtml">Regmon</a> 
                                  - a Registry monitor</font></li>
                                <li><font color="#000000"><a href="../../ntw2k/freeware/tdimon.shtml">Tdimon</a> 
                                  - a TCP/IP monitor</font></li>
                                <li><a href="../../ntw2k/freeware/portmon.shtml">Portmon</a> 
                                  - a serial and parallel port monitor</li>
                                <li><a href="../../ntw2k/freeware/pmon.shtml">PMon</a> 
                                  - a process and thread monitor (NT/Win2K)</li>
                                <li><a href="../../ntw2k/freeware/diskmon.shtml">Diskmon</a> 
                                  - a hard disk monitor (NT/Win2K)</li>
                                <li><a href="../../ntw2k/freeware/debugview.shtml">DebugView</a> 
                                  - a debug output monitor<font face="arial"></font></li>
                              </ul>
                              </td>
                          </tr>
						  						                            <tr> 
                            <td colspan="3" height="40" valign="middle"><span class='sectionheader'>More Information 
</span></td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3" align="left"> The following 
                              serve as additional sources of information on the 
                              Windows 9x file system:
<ul>
                                <li>The Windows 95/98 DDK </li>
                                <li>&quot;Examining the Windows 95 Layered File 
                                  System,&quot; by Mark Russinovich and Bryce 
                                  Cogswell, Dr. Dobb's Journal, December 1995 
                                </li>
                                <li><a
href="../../othresources.shtml#books">&quot;Systems Programming for Windows 95,&quot;</a> 
                                  by Walter Oney, Microsoft Press, 1996 (a must-have 
                                  for VxD writers)</li>
                                <li><a
href="../../othresources.shtml#books">&quot;Inside the Windows 95 File System,&quot;</a> 
                                  by Stan Mitchell, O'Reilly and Associates, 1996</li>
                              </ul>
                              <p>These are source of information on the Windows 
                                NT/2000 file system and/or Filemon:</p>
                              <ul>
                                <li><a href="../../insidew2k.shtml">Inside Windows 
                                  2000, 3rd Edition</a> by David Solomon and Mark 
                                  Russinovich, 2000</li>
                                <li>&quot;Examining The Windows NT File System,&quot; 
                                  by Mark Russinovich and Bryce Cogswell, Dr. 
                                  Dobb's Journal, Febrary 1997 </li>
                                <li>&quot;<a
href="http://www.ntmag.com">Inside NT Utilities</a>&quot;, Windows NT Magazine, 
                                  February 1999. </li>
                                <li><a
href="../../othresources.shtml#books">&quot;Windows NT File System Internals,&quot;</a>by 
                                  Rajeev Nagar, O'Reilly and Associates, 1997</li>
                              </ul>
                            </td>
                          </tr>
						                            <tr> 
                            <td colspan="3" height="49" valign="middle"><a href="http://www.winternals.com"><img src="../../images/WinProd.gif" width="87" height="29" border="0"></a></td>
                          </tr>
                          <tr> 
                            <td valign="TOP" colspan="3" align="left"> 
                              <p><i>Filemon Enterprise Edition</i>, the commercial 
                                version of <i>Filemon</i> available from <a href="http://www.winternals.com">Winternals 
                                Software</a>, extends the functionality of <i>Filemon</i> 
                                with several powerful features, including the 
                                ability to monitor remote systems and save output 
                                to a log file as the output generates.</p>
                              <p>&nbsp;</p>
                            </td>
                          </tr>


						                            <tr> 
                            <td colspan="3" height="40" valign="middle" align="center"> 
                              <p><strong>In order to help us track its use, please 
                                download through the link that represents the 
                                operating system on which you will use or mostly 
                                use </strong><em><strong>Filemon. </strong></em><strong><br>
                                Note that the zip files are identical, and </strong><em><strong>Filemon</strong></em><strong> 
                                runs on either platform.</strong></p>
                              <p><a href="../../files/FILEMON.ZIP"><b>Download Filemon 
                                (x86- 76KB) - you plan on using Filemon on Win9x</b></a></p>
                              <p><a href="../../files/NTFILMON.ZIP"><b>Download 
                                Filemon (x86 - 76KB) - you plan on using Filemon 
                                on WinNT/2K/XP</b></a></p>
                              <p><b><a href="../../files/filemon64.zip">Download 
                                Filemon (XP 64-bit Edition/IA64 -146KB )</a></b></p>
                              <p><a href="../../files/FILEAXP.ZIP"><b>Download Filemon 
                                (Alpha - 92KB)</b></a></p>
                              <p><a href="../../files/FILESRC.ZIP"><b>Download 
                                Filemon Plus Source (702KB)</b></a></p>
<a href="#top"><b>Back to Top</b></a> </td>
                          </tr>

                        </table>
                      </td>
                    </tr>
                  </table>
                </TD>
              </TR>
            </TABLE>
            <!-- #EndEditable --></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
</body>
<!-- #EndTemplate --></html>
